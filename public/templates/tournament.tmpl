<div class="return"><span></span><a href="<?=LanWebsite_Main::buildUrl(false, "tournaments")?>">Return to tournaments</a></div>

<div class="tournament-header">
    <div class="tournament-logo"><img src="<?=LanWebsite_Tournaments::getIcon($DataBag["tournament"]["game"])?>" /></div>
    <div class="title"><?=$DataBag["tournament"]["name"]?></div>
</div>

<div id="info-container">
    <div id="tournament-info">
        <div class="info-element">
            <div class="info-left">Game:</div>
            <div class="info-right"><?=LanWebsite_Tournaments::getGame($DataBag["tournament"]["game"])?></div>
        </div>
        <div class="info-element">
            <div class="info-left">Team Size:</div>
            <div class="info-right"><?=$DataBag["tournament"]["team_size"]?></div>
        </div>
<?php
if ($DataBag["tournament"]["signups"] == 1) {
?>
        <div class="info-element">
            <div class="info-left">Signups close:</div>
            <div class="info-right"><?=date('g:ia D', $DataBag["tournament"]["signup_close"])?></div>
        </div>
<?php
}
?>
        <div class="info-element">
            <div class="info-left">Starts:</div>
            <div class="info-right"><?=date('g:ia D', $DataBag["tournament"]["start_time"])?></div>
        </div>
        <div class="info-element">
            <div class="info-left">Ends:</div>
            <div class="info-right"><?=date('g:ia D', $DataBag["tournament"]["end_time"])?></div>
        </div>
        <div class="info-element">
            <div class="info-left">Format:</div>
            <div class="info-right"><?=LanWebsite_Tournaments::getType($DataBag["tournament"]["type"])?></div>
        </div>
        <div class="info-element">
            <div class="info-left">Description:</div>
            <div class="info-right description"><?=$DataBag["tournament"]["description"]?></div>
        </div>
    </div>
</div>

<div style="clear: both;"></div>

<?php
if($DataBag["tournament"]["signups"] == 1) {
?>


<div id="tournament-buttons">
<?php
    if(!$DataBag["signed-up"]) {
        if($DataBag["signups"]["team_id"] < 1) echo '<button id="create-team">Create Team</button>';
        echo '<button id="join-solo">Join Solo</button>';
    } else {
        echo '<button id="leave-tournament">Leave Tournament</button>';
    }
?>
</div>

<?php 
}
?>

<div id="tournament-tabs">

    <ul>
<?php 
        if($DataBag["tournament"]["team_size"] > 1) { echo '<li><a href="#teams">Teams</a></li>'; }
        else { echo '<li><a href="#signups">Signups</a></li>'; }
        
        if(count($DataBag["brackets"])) { echo '<li><a href="#tabs-2">Bracket</a></li>'; }
        if(count($DataBag["matches"])) { echo '<li><a href="#tabs-3">Matches</a></li>'; }
?>
    </ul>
    
<?php 
if ($DataBag["tournament"]["team_size"] > 1) {
?>
        <div id="teams">
            <div id="team-list">
<?
    foreach($DataBag["signup_list"] as $team) {
?>
                <a href="<?=LanWebsite_Main::buildUrl(false, "tournaments", "team", array("teamid" => $team["team_id"]))?>">
                    <div class="team">
                        <span class="team-name"><?=$team["team_name"]?></span>
                        <span class="team-leader">Captain: <?=($team["leader_id"] > 0) ? LanWebsite_Main::getUserManager()->getUserById($team["leader_id"])->getUsername() : '-'?></span>
                        <span class="playercount"><?=count($team["players"])?>/<?=$DataBag["tournament"]["team_size"]?></span>
                    </div>
                </a>
<?php
    }
?>
            </div>
        </div>
<?php 
} else { ?>
        <div id="signups">
<?php
    foreach($DataBag["signup_list"] as $signupUser) {
        $user = LanWebsite_Main::getUserManager()->getUserById($signupUser['user_id']);
        if(!$user) continue;
?>
            <a href="<?=LanWebsite_Main::buildUrl(false, "profile", null, array('userid'=>$user->getUserId()))?>">
                <div class="user">
                    <span class="user-name"><?=$user->getFullName()?></span>
                </div>
            </a>
<?php
    }
?>
        </div>
<?php
}
    
if(count($DataBag["brackets"]) > 0) {
?>
        <div id="tabs-2">
            herp
        </div>
<?php
}
    
if(count($DataBag["matches"]) > 0) {
?>
    <div id="tabs-3">
        merp
    </div>
<?php
}
?>
    
</div>